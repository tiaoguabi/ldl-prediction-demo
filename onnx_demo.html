<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LDL Prediction</title>
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/onnxruntime.min.js"></script>
</head>
<body>
    <h1>LDL Prediction Model</h1>
    <form id="inputForm">
        <label for="tc">Total Cholesterol (TC):</label>
        <input type="number" id="tc" required><br><br>

        <label for="tg">Triglycerides (TG):</label>
        <input type="number" id="tg" required><br><br>

        <label for="hdl">HDL Cholesterol:</label>
        <input type="number" id="hdl" required><br><br>

        <button type="submit">Predict LDL</button>
    </form>

    <h2>Predicted LDL: <span id="result">-</span></h2>

    <script>
        async function loadModel() {
            // 加载GitHub上托管的ONNX模型
            const session = await ort.InferenceSession.create('https://raw.githubusercontent.com/tiaoguabi/ldl-prediction-demo/main/ebm_model.onnx');
            return session;
        }

        async function predict(event) {
            event.preventDefault();
            const tc = parseFloat(document.getElementById('tc').value);
            const tg = parseFloat(document.getElementById('tg').value);
            const hdl = parseFloat(document.getElementById('hdl').value);

            // 准备输入数据
            const inputData = new ort.Tensor('float32', new Float32Array([tc, tg, hdl]), [1, 3]);

            // 加载模型并进行预测
            const session = await loadModel();
            const output = await session.run({ 'Total cholesterol': inputData, 'triglycerides': inputData, 'HDL cholesterol': inputData });

            // 假设预测结果是数组，并且只包含一个预测值
            const prediction = output[0].data[0];  // 修改为正确的索引

            document.getElementById('result').innerText = prediction.toFixed(2);  // 显示预测值
        }

        document.getElementById('inputForm').addEventListener('submit', predict);
    </script>
</body>
</html>
